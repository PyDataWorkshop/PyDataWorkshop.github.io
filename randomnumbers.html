	
\section{Random Number Generation with NumPy}

 For the sake of brevity, the specific functions names are given in the example below, rather than the full specification.

The \texttt{rand()} command is fully specified as \texttt{np.random.rand()}


% 19.1 Simulating Random Variables
% - 19.1.1 Core Random Number Generators
NumPy random number generators are all stored in the module \texttt{numpy.random}. 
These can be imported with using \texttt{import numpy as np} and then calling \texttt{np.random.rand}, for example, or 
by importing \texttt{import numpy.random as rnd} and \texttt{using rnd.rand.1}.
<h5>\texttt{rand}, \texttt{random\_sample</h5>
\texttt{rand} and \texttt{random\_sample }are uniform randomnumber generators whichare
 identicalexceptthat rand takes a variable number 
of integer inputs – one for each dimension – while \texttt{random\_sample} takes a n-element tuple. 

 \texttt{random\_sample} is the preferred NumPy function, and \texttt{rand} is a convenience function primarily for \textit{MATLAB} users.
<pre>
<code>
x = rand(3,4,5) 
y = random_sample((3,4,5))
</code>
</pre>


<br>
<h5>\texttt{randn, standard\_normal</h5>
<ul>
<li> \texttt{randn} and \texttt{standard\_normal} are standard normal (i.e. Z-value) random number generators. \texttt{randn}, like \texttt{rand}, takes a
variable number of integer inputs, and \texttt{standard\_normal} takes an n-element tuple. 
<li> Both can be called
with no arguments to generate a single standard normal (e.g. randn()). 
<li> \texttt{standard\_normal }is the preferred
NumPy function, and \texttt{randn} is a convenience function intended primarily for MATLAB users .
</ul>

<pre>
<code>
>>> x = randn(3,4,5)
>>> y = standard_normal((3,4,5))
</code>
</pre>
<br>
%========================================= %
<h5>\texttt{randint, random\_integers</h5>
\texttt{randint} and \texttt{random\_integers} are uniform integer random number generators which take 3 inputs: low,
high and size. 
<ul>
<li> \texttt{low} is the lower bound of the integers generated, 
<li> \texttt{high} is the upper,
<li> \texttt{size} is a n-elementtuple. 
</ul>

<b>Important:</b><br>
 \texttt{randint} and \texttt{random\_integers} differ in that \texttt{randint} generates integers exclusive of the value in \texttt{high}
(as do most Python functions), while \texttt{random\_integers} includes the value in \texttt{high} in its range.
<pre>
<code>
x = randint(0,10,(100))
x.max() 
# Is 9 since range is [0,10)

y = random_integers(0,10,(100))
y.max() 
# Is 10 since range is [0,10]
</code>
</pre>
%================================================ %
% -------19.1.2 Random Array Functions
<br>
<h5>\texttt{shuffle</h5>
\texttt{shuffle} randomly reorders the elements of an array in place.
<pre>
<code>
>>> x = arange(10)
>>> shuffle(x)
>>> x
array([4, 6, 3, 7, 9, 0, 2, 1, 8, 5])
</code>
</pre>

%================================================ %
<h5>\texttt{permutation</h5>
\texttt{permutation} returns randomly reordered elements of an array as a copy while not directly changing the
input.
<pre>
<code>
>>> x = arange(10)
>>> permutation(x)
array([2, 5, 3, 0, 6, 1, 9, 8, 4, 7])
>>> x
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
</code>
</pre>
% -------19.1.3 Select Random Number Generators
<ul>
<li> NumPy provides a large selection of random number generators for specific distribution. 
<li> All take between
0 and 2 required inputs which are parameters of the distribution, plus a tuple containing the size of the
output. 
<li> All random number generators are in the module \texttt{numpy.random}.
</ul>
<br>

<h5>\texttt{seed</h5>
% 19.2.2 
<ul>
<li> \texttt{numpy.random.seed} is a more useful function for initializing the random number generator, and can be
used in one of two ways. \texttt{seed()} will initialize (or reinitialize) the random number generator using some
actual random data provided by the operating system.

<li> \texttt{seed( s )} takes a vector of values (can be scalar) to
initialize the random number generator at particular state. 
<li> \texttt{seed( s )} is particularly useful for producing
simulation studies which are reproducible. 
\subsubsection*{Example}
In the following example, calls to \texttt{seed()} produce different
random numbers, since these reinitialize using random data from the computer, while calls to \texttt{seed(0)}
produce the same random number or sequence of random numbers.
<br>
</ul>
<pre>
	<code>
	>>> seed()
	>>> randn()
	
	array([ 0.62968838])
	>>>
	>>> seed()
	>>> randn()
	
	array([ 2.230155])
	>>> ## Different
	>>>
	>>> seed(0)
	>>> randn()
	
	array([ 1.76405235])
	>>>
	>>> seed(0)
	>>> randn()
	
	array([ 1.76405235])
	>>> #Same as last draw
	</code>
</pre>
NumPy always calls \texttt{seed()}  when the first random number is generated. As a result. calling \texttt{standard\_normal()}
across two “fresh” sessions will not produce the same random number.
<br>

% 19.1.2 Random Array Functions
%======================================================================== %
% 19.1.3 Select Random Number Generators
<h5>Select Random Number Generators}
<ul>
<li> NumPy provides a large selection of random number generators for specific distribution. 

<li> All take between 0 and 2 required inputs which are parameters of the distribution, plus a tuple containing the size of the output. 
<li> All random number generators are in the module 
\texttt{numpy.random}.
</ul>


<h5>Bernoulli}
<ul>
<li> There is no \textbf{\textit{Bernoulli generator</h5>. 
<li> Instead use \texttt{binomial(1,p)} to generate a single draw or \texttt{binomial(1,p,(10,10))} to generate an array where 
\texttt{p} is the probability of success.
</ul>



%=================================%

%19.2 Simulation and Random Number Generation
<h5>Simulation and Random Number Generation}
<ul>
<li> Computer simulated random numbers are usually constructed from very complex but ultimately deterministic
functions. 
<li> Because they are not actually random, simulated random numbers are generally described
to as \textbf{pseudo-random}. 
<li> All pseudo-random numbers in NumPy use one core random number generator
based on the \textbf{\textit{Mersenne Twister</h5>, a generator which can produce a very long series of pseudo-random
data before repeating (up to $2^19937 - 1$ non-repeating values).
</ul>
%======================================================== %
<br>
<h5>\texttt{RandomState</h5>
\texttt{RandomState} is the class used to control the random number generators. Multiple generators can be initialized
by \texttt{RandomState}.
<pre>
	<code>
	>>> gen1 = np.random.RandomState()
	>>> gen2 = np.random.RandomState()
	>>>
	>>> # Generate a uniform
	>>> gen1.uniform() 
	
	    0.6767614077579269
	>>>
	>>> state1 = gen1.get_state()
	>>> gen1.uniform()
	
		0.6046087317893271
	>>>
	>>> # Different, since gen2 has different seed
	>>> gen2.uniform()
	
		0.04519705909244154
	>>>
	>>> # Same uniform as gen1 after assigning state
	>>> gen2.set_state(state1)
	>>> gen2.uniform() 
		
		0.6046087317893271
	</code>
</pre>
%==============%
% 19.2.1
<h5>\texttt{ State</h5>
<ul>
<li> Pseudo-random number generators track a set of values known as the \textit{state}. 
<li> The state is usually a vector
which has the property that if two instances of the same pseudo-random number generator have the
same state, the sequence of pseudo-random numbers generated will be identical. 
<li> The state of the default
random number generator can be read using \\ \texttt{numpy.random.get\_state} and can be restored using
\texttt{numpy.random.set\_state}.
</ul>

<pre>
	<code>>>> st = get_state()
	>>> randn(4)
	
	array([ 0.37283499, 0.63661908, 1.51588209,	1.36540624])
	>>>
	>>> set_state(st)
	>>> randn(4)
	
	array([ 0.37283499, 0.63661908, 1.51588209,	1.36540624])
	</code>
</pre>
<ul>
<li> The two sequences are identical since they the state is the same when \texttt{randn} is called. 
<li> The state is a 5-
element tuple where the second element is a 625 by 1 vector of unsigned 32-bit integers. 
<li> In practice the
state should only be stored using \texttt{get\_state} and restored using \texttt{set\_state}.
</ul>

<br>

<h5>\texttt{get\_state</h5>
%19.2
<ul>
<li> \texttt{get\_state()} gets the current state of the random number generator, which is a 5-element tuple. 
<li> It can be
called as a function, in which case it gets the state of the default random number generator, or as a method
on a particular instance of \texttt{RandomState}.
</ul>

<h5>\texttt{set\_state</h5>
%19.2.1
<ul>
<li> \texttt{set\_state(state)} sets the state of the random number generator. 
<li> It can be called as a function, in which
case it sets the state of the default random number generator, or as a method on a particular instance of
\texttt{RandomState}.<li> \texttt{set\_state} should generally only be called using a state tuple returned by \texttt{get\_state}.
</ul>
